# Telegram-бот "Эксперт по Human Design"

## Описание проекта
Telegram-бот "Эксперт по Human Design" — это интеллектуальный чат-бот, разработанный для предоставления информации и ответов на вопросы, связанные с системой "Human Design". Бот поддерживает диалоговый режим, обрабатывает запросы на русском и английском языках, сохраняет историю чатов и фильтрует вопросы, не относящиеся к тематике Human Design.

## Основные функции
- **Экспертность по Human Design**: Отвечает на вопросы, связанные с типами, центрами, профилями, авторитетами, воротами, линиями и каналами в системе Human Design.
- **Фильтрация тем**: На вопросы, не связанные с Human Design (например, астрология, таро, психология), бот отвечает стандартной фразой:  
  «Я специализируюсь только на Human Design. По этому вопросу советую обратиться к соответствующему эксперту или боту.»
- **Поддержка языков**: Обработка запросов на русском и английском язы;EA: языках с возможностью переключения.
- **Диалоговый режим**: Поддержка продолжительных диалогов с сохранением контекста и истории сообщений.
- **Сохранение и управление чатами**: Возможность сохранять, открывать, переименовывать и удалять чаты.
- **Команды бота**:
  - `/start` — запуск бота и выбор языка.
  - `/chat` — начало или продолжение диалога.
  - `/reset` — сброс контекста чата с возможностью сохранения.
  - `/history` — просмотр списка сохранённых чатов.
  - `/help` — отображение списка команд.

## Технологии
- **Язык программирования**: Python
- **Фреймворк**: Aiogram (асинхронная библиотека для работы с Telegram Bot API)
- **База данных**: SQLite (с использованием SQLAlchemy)
- **Интеграция с AI**: Hugging Face Inference API (модель Mixtral-8x7B-Instruct-v0.1)
- **Логирование**: Встроенный модуль `logging` с записью в файл `bot.log`
- **Конфигурация**: Переменные окружения через `.env` (BOT_TOKEN, AI_API_KEY)

## Установка и запуск

### Требования
- Python 3.8+
- Установленные зависимости (указаны в `requirements.txt`)

### Настройка
1. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

2. **Создайте файл `.env`** в корневой директории проекта и добавьте следующие переменные:
   ```
   BOT_TOKEN=ваш_токен_бота_от_Telegram
   AI_API_KEY=ваш_ключ_API_от_HuggingFace
   ```

3. **Создайте базу данных**:
   - База данных SQLite (`bot_database.db`) создаётся автоматически при первом запуске бота.

4. **Запустите бота**:
   ```bash
   python main.py
   ```

### Структура проекта
- `main.py` — основной файл для запуска бота, инициализация Aiogram и маршрутизаторов.
- `states.py` — определение состояний для FSM (Finite State Machine) Aiogram.
- `models.py` — модели базы данных (User, ChatHistory) и методы для работы с SQLite.
- `config.py` — загрузка конфигурации из `.env`.
- `ai.py` — интеграция с AI (Hugging Face) для обработки запросов.
- `keyboards.py` — клавиатуры для выбора языка и сохранения чатов.
- `handlers/` — обработчики команд и сообщений:
  - `start.py` — обработка команды `/start` и выбор языка.
  - `chat.py` — обработка диалогов и вопросов по Human Design.
  - `reset.py` — сброс контекста чата с сохранением.
  - `history.py` — управление сохранёнными чатами (просмотр, открытие, переименование, удаление).
  - `help.py` — отображение справки по командам.
- `requirements.txt` — список зависимостей для установки.

## Использование
1. **Запуск бота**:
   - Отправьте команду `/start` для выбора языка (Русский или English).
   - После выбора языка бот предложит задать вопрос по Human Design.

2. **Диалог**:
   - Используйте команду `/chat` для начала или продолжения диалога.
   - Задавайте вопросы, связанные с Human Design, например:  
     _"Что означает Манифестирующий Генератор в Human Design?"_  
     _"Как интерпретировать открытые центры в бодиграфии?"_

3. **Управление чатами**:
   - `/reset` — сброс текущего контекста с возможностью сохранения чата.
   - `/history` — просмотр и управление сохранёнными чатами.
   - `/help` — список доступных команд.

4. **Завершение диалога**:
   - Бот автоматически завершит диалог при использовании слов "пока", "до свидания", "bye", "goodbye".

## Ограничения
- Бот отвечает только на вопросы по Human Design.
- Максимальная длина одного сообщения — 4096 символов (длинные ответы разбиваются на части).
- Названия чатов не должны быть пустыми или длиннее 100 символов.

## Логирование
- Все действия бота и ошибки записываются в файл `bot.log` для отладки и мониторинга.

## Разработка и поддержка
- Для добавления новых функций или исправления ошибок создавайте issues в репозитории.
- Для интеграции с другими AI-моделями измените настройки в `ai.py`.